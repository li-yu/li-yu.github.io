<html>
<head>
    <meta charset="utf-8" />
<meta name="description" content="" />
<meta name="viewport" content="width=device-width, initial-scale=1" />

<title>å¦ä¸€ç§ App ç½‘é¡µåŠ è½½æ–¹å¼ | å‘µå‘µå°é±¼</title>

<link rel="shortcut icon" href="https://liyuyu.cn/favicon.ico?v=1770856511184">
<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/lxgw-wenkai-screen-webfont@1.6.0/style.css" />
<link href="https://cdn.jsdelivr.net/npm/@fortawesome/fontawesome-free/css/all.min.css" rel="stylesheet">
<link rel="stylesheet" href="https://liyuyu.cn/styles/main.css">
<!-- <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap@4.5.0/dist/css/bootstrap.min.css"> -->

<script src="https://cdn.jsdelivr.net/npm/@highlightjs/cdn-assets/highlight.min.js"></script>
<script src="https://cdn.bootcdn.net/ajax/libs/highlight.js/9.12.0/languages/dockerfile.min.js"></script>
<script src="https://cdn.bootcdn.net/ajax/libs/highlight.js/9.12.0/languages//dart.min.js"></script>

<!-- <script src="https://cdn.jsdelivr.net/npm/moment@2.27.0/moment.min.js"></script> -->
<!-- <script src="https://cdn.jsdelivr.net/npm/jquery@3.5.1/dist/jquery.slim.min.js"></script> -->
<!-- <script src="https://cdn.jsdelivr.net/npm/popper.js@1.16.0/dist/umd/popper.min.js"></script> -->
<!-- <script src="https://cdn.jsdelivr.net/npm/bootstrap@4.5.0/dist/js/bootstrap.min.js"></script> -->
<!-- DEMO JS -->
<!--<script src="media/scripts/index.js"></script>-->



    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/katex@0.12.0/dist/katex.css">
    
</head>
<body>
<div class="main gt-bg-theme-color-first">
    <nav class="navbar navbar-expand-lg">
    <a class="navbar-brand" href="/">
        <img class="user-avatar" src="/images/avatar.png" alt="å¤´åƒ">
        <div class="site-name gt-c-content-color-first">
            å‘µå‘µå°é±¼
        </div>
    </a>
    <button class="navbar-toggler" type="button" data-toggle="collapse" data-target="#navbarSupportedContent"
        aria-controls="navbarSupportedContent" aria-expanded="false" aria-label="Toggle navigation" id="changeNavbar">
        <i class="fas fa-bars gt-c-content-color-first" style="font-size: 18px"></i>
    </button>
    <div class="collapse navbar-collapse" id="navbarSupportedContent">
        <div class="navbar-nav mr-auto" style="text-align: center">
            
            <div class="nav-item">
                
                <a href="/" class="menu gt-a-link">
                    é¦–é¡µ
                </a>
                
            </div>
            
            <div class="nav-item">
                
                <a href="/archives" class="menu gt-a-link">
                    å½’æ¡£
                </a>
                
            </div>
            
            <div class="nav-item">
                
                <a href="/post/about" class="menu gt-a-link">
                    å…³äº
                </a>
                
            </div>
            
        </div>
        <div style="text-align: center">
            <form id="gridea-search-form" style="position: relative" data-update="1770856511184"
                action="/search/">
                <input class="search-input" autocomplete="off" spellcheck="false" name="q" placeholder="æœç´¢æ–‡ç« " />
                <i class="fas fa-search gt-c-content-color-first" style="position: absolute; top: 9px; left: 10px;"></i>
            </form>
        </div>
    </div>
</nav>
<script>
    /* ç§»åŠ¨ç«¯å¯¼èˆªæ å±•å¼€/æ”¶èµ·åˆ‡æ¢ */
    document.getElementById('changeNavbar').onclick = () => {
        var element = document.getElementById('navbarSupportedContent');
        if (element.style.display === 'none' || element.style.display === '') {
            element.style.display = 'block';
        } else {
            element.style.display = 'none';
        }
    }
</script>

    <div class="post-container">
        <div class="post-detail gt-bg-theme-color-second">
            <article class="gt-post-content">
                <h2 class="post-title">
                    å¦ä¸€ç§ App ç½‘é¡µåŠ è½½æ–¹å¼
                </h2>
                <div class="post-info">
                    <time class="post-time gt-c-content-color-first">
                        Â· 2024-11-01 Â·
                    </time>
                    
                </div>
                <div class="post-content">
                    <p>å¾ˆå¤š App éƒ½ä¼šæœ‰åŠ è½½ç½‘é¡µçš„åœºæ™¯</p>
<!-- more -->
<p>ä¸€èˆ¬æœ‰å¦‚ä¸‹å‡ ç§æ–¹å¼ï¼š</p>
<ul>
<li>è·³è½¬<code>å¤–éƒ¨æµè§ˆå™¨</code>æ‰“å¼€ï¼ˆç®€å•ç²—æš´ï¼Œä¸€è¡Œä»£ç ï¼Œä½†æ˜¯ä¸šåŠ¡å½¢æ€å‰²è£‚ï¼Œæˆ‘ä»¬è‡ªå·±çš„ App ä¼šè¿›å…¥åå°ï¼‰</li>
<li>å†…åµŒ <code>WebView/WKWebView</code> å®ç°ï¼ˆé¡µé¢äº¤äº’é€»è¾‘å¯æ§ï¼Œç»†èŠ‚å¯å®šåˆ¶ï¼Œä¸ºä¸»æµæ–¹å¼ï¼Œä½†ç¼ºç‚¹æ˜¯æ€§èƒ½ä»¥åŠå…¼å®¹é—®é¢˜ï¼ŒåŒæ—¶ä¹Ÿæ— æ³•ä¸å¤–éƒ¨æµè§ˆå™¨å…±äº« cookies ç­‰æ•°æ®ï¼‰</li>
<li>Android <code>Custom Tabs</code>/iOS <code>SFSafariViewController</code> ğŸ‰</li>
</ul>
<p>Android <code>Custom Tabs</code> åŸºäº Intent è°ƒç”¨ï¼Œä¾èµ–æ‰‹æœºé‡Œ Chrome æµè§ˆå™¨ï¼ˆæˆ–åŸºäº Chromium å†…æ ¸çš„æµè§ˆå™¨ï¼‰å®ç°ï¼Œä¸åŒç‰ˆæœ¬å¯èƒ½ä¼šæœ‰å·®å¼‚ã€‚<br>
æ—©åœ¨ 2015 å¹´ Google å°±å‘å¸ƒäº†å¯¹åº”çš„ <code>support</code> ä¾èµ–åº“ï¼Œååœ¨ 2018 å¹´è¿ç§»åˆ°äº† AndroidXï¼Œæ›´åä¸º <code>browser</code>ã€‚ç›®å‰å›½å¤–çš„ä¸»æµ App éƒ½å®ç°äº†è¯¥åŠŸèƒ½ï¼Œä¾‹å¦‚ Xã€Telegram ç­‰ï¼Œè€Œå›½å†…å´å¯¥å¯¥æ— å‡ ã€‚</p>
<p>iOS å¹³å°ä¹Ÿæä¾›äº†ç±»ä¼¼çš„è§£å†³æ–¹æ¡ˆï¼š<code>SFSafariViewController</code><br>
WKWebView æ˜¯ WebKit æ¡†æ¶çš„ä¸€éƒ¨åˆ†ï¼Œ<code>SFSafariViewController</code> æ˜¯ SafariServices æ¡†æ¶çš„ä¸€éƒ¨åˆ†ï¼Œå¯è®©ç”¨æˆ·ç›´æ¥åœ¨åº”ç”¨å†…æµè§ˆç½‘é¡µï¼Œäº«å—ä¸åœ¨ Safari ä¸­ç›¸åŒçš„ç½‘é¡µæµè§ˆä½“éªŒ - åŒ…æ‹¬å¯†ç è‡ªåŠ¨å¡«å……ã€é˜…è¯»å™¨å’Œå®‰å…¨æµè§ˆç­‰åŠŸèƒ½ï¼Œè€Œæ— éœ€ç¦»å¼€æˆ‘ä»¬çš„åº”ç”¨ã€‚</p>
<h4 id="å¼€å§‹ä½¿ç”¨">å¼€å§‹ä½¿ç”¨</h4>
<ol>
<li>æ·»åŠ ä¾èµ–</li>
</ol>
<pre><code>dependencies {
   implementation 'androidx.browser:browser:1.8.0'
}
</code></pre>
<ol start="2">
<li>åˆ¤æ–­æ‰‹æœºç³»ç»Ÿæ˜¯å¦æ”¯æŒ<br>
æ‰‹æœºéœ€è¦å®‰è£… Chrome 45 æˆ–ä»¥ä¸Šç‰ˆæœ¬ï¼Œå¹¶ä¸”è®¾ä¸ºé»˜è®¤æµè§ˆå™¨ï¼Œå®æµ‹ Edge æµè§ˆå™¨ä¹Ÿæ”¯æŒ<br>
å¦‚æœæ¡ä»¶éƒ½ä¸æ»¡è¶³ï¼Œåˆ™è·³è½¬å…¶ä»–å¤–éƒ¨æµè§ˆå™¨æ‰“å¼€</li>
</ol>
<pre><code class="language-java">String packageName = CustomTabsClient.getPackageName(context, Collections.emptyList());
if (packageName == null) {
    // not supported
}
Intent activityIntent = new Intent(Intent.ACTION_VIEW, Uri.parse(&quot;http://www.example.com&quot;));
PackageManager packageManager = context.getPackageManager();
List&lt;ResolveInfo&gt; viewIntentHandlers = packageManager.queryIntentActivities(activityIntent, 0);
String packageName = CustomTabsClient.getPackageName(context, viewIntentHandlers, true);
if (packageName == null) {    
    // not supported
}
</code></pre>
<ol start="3">
<li>AndroidManifest.xml å¤„ç†åŒ…å¯è§æ€§ï¼ˆAndroid 11 åŠä»¥ä¸Šï¼‰</li>
</ol>
<pre><code class="language-xml">&lt;queries&gt;
    &lt;intent&gt;
        &lt;action android:name=
            &quot;android.support.customtabs.action.CustomTabsService&quot; /&gt;
    &lt;/intent&gt;
&lt;/queries&gt;
</code></pre>
<ol start="4">
<li>å‘èµ·è°ƒç”¨</li>
</ol>
<pre><code class="language-java">String url = &quot;https://developers.android.com&quot;;
CustomTabsIntent intent = new CustomTabsIntent.Builder().build();
intent.launchUrl(MainActivity.this, Uri.parse(url));
</code></pre>
<p>è¯¦ç»†ç‰¹æ€§</p>
<ul>
<li>æ”¯æŒå®šåˆ¶éƒ¨åˆ† UI</li>
<li>æ”¯æŒé¢„çƒ­å’Œé¢„åŠ è½½</li>
<li>æ”¯æŒæœ€å°åŒ–ï¼ˆç”»ä¸­ç”»ï¼‰</li>
<li>æ”¯æŒ ToolBar è‡ªå®šä¹‰æŒ‰é’®</li>
<li>æ”¯æŒæŒ‡å®šé«˜åº¦æ‰“å¼€</li>
<li>æ”¯æŒè®¾ç½®è¿›å…¥å’Œé€€å‡ºåŠ¨ç”»</li>
<li>æ”¯æŒä¼ é€’ HTTP headers ç­‰</li>
</ul>
<h4 id="ä¼˜ç‚¹">ä¼˜ç‚¹</h4>
<ul>
<li>Custom Tabs æä¾›äº†ä¸€è‡´çš„æµè§ˆä½“éªŒï¼Œä¸ Chrome æµè§ˆå™¨çš„å¤–è§‚å’ŒåŠŸèƒ½ä¿æŒä¸€è‡´ï¼Œç”¨æˆ·åœ¨ä½¿ç”¨æ—¶æ„Ÿåˆ°ç†Ÿæ‚‰å’Œèˆ’é€‚ã€‚</li>
<li>ç”±äºä½¿ç”¨ Chrome æµè§ˆå™¨ï¼ŒCustom Tabs åœ¨æ€§èƒ½ä¸Šé€šå¸¸ä¼˜äº WebViewï¼Œèƒ½å¤Ÿæ›´å¿«åœ°åŠ è½½ç½‘é¡µã€‚</li>
<li>Custom Tabs åœ¨å®‰å…¨æ€§ä¸Šæ›´å¼ºï¼Œåˆ©ç”¨ Chrome çš„å®‰å…¨åŠŸèƒ½ï¼Œä¾‹å¦‚å¯¹æ¶æ„è½¯ä»¶çš„é˜²æŠ¤å’Œå¼ºå¤§çš„éšç§è®¾ç½®ã€‚</li>
<li>å¯ä»¥åˆ©ç”¨æµè§ˆå™¨çš„æ‰€æœ‰åŠŸèƒ½ï¼ŒåŒ…æ‹¬è‡ªåŠ¨å¡«å……ã€ä¹¦ç­¾å’Œè·¨è®¾å¤‡çš„åŒæ­¥ï¼Œä½¿å¾—ç”¨æˆ·èƒ½å¤Ÿäº«å—åˆ°æ›´å…¨é¢çš„æµè§ˆä½“éªŒã€‚</li>
<li>ä¸ WebView ç›¸æ¯”ï¼ŒCustom Tabs ä¸éœ€è¦å¼€å‘è€…ç»´æŠ¤ç½‘é¡µå†…å®¹çš„å‘ˆç°ï¼Œå‡å°‘äº†å¼€å‘å’Œç»´æŠ¤çš„å·¥ä½œé‡ã€‚</li>
<li>å¼€å‘è€…å¯ä»¥å¯¹ Custom Tabs è¿›è¡Œä¸€äº›å®šåˆ¶ï¼Œæ¯”å¦‚ä¿®æ”¹é¢œè‰²å’Œæ·»åŠ è‡ªå®šä¹‰èœå•ï¼Œå¢å¼ºå“ç‰Œè¯†åˆ«åº¦ã€‚</li>
</ul>
<h4 id="ç¼ºç‚¹">ç¼ºç‚¹</h4>
<ul>
<li>å¼€å‘è€…å¯¹ Custom Tabs çš„æ§åˆ¶ç›¸å¯¹æœ‰é™ï¼Œæ— æ³•åƒä½¿ç”¨ WebView é‚£æ ·å¯¹ç½‘é¡µçš„è¡Œä¸ºå’Œå¤–è§‚è¿›è¡Œå…¨é¢æ§åˆ¶ã€‚</li>
<li>Custom Tabs ä¾èµ–äºç”¨æˆ·çš„ Chrome æµè§ˆå™¨æˆ–å…¶ä»–æ”¯æŒ Custom Tabs çš„æµè§ˆå™¨ã€‚å¦‚æœç”¨æˆ·æ²¡æœ‰å®‰è£…æ”¯æŒçš„æµè§ˆå™¨ï¼Œå¯èƒ½ä¼šå¯¼è‡´ä½“éªŒä¸ä½³ã€‚</li>
<li>æŸäº›ç‰¹å®šçš„ WebView åŠŸèƒ½å¯èƒ½æ— æ³•åœ¨ Custom Tabs ä¸­ä½¿ç”¨ï¼Œä¾‹å¦‚ä¸ JavaScript çš„æ·±åº¦äº¤äº’ã€‚</li>
</ul>
<h4 id="æœ€ä½³å®è·µåœºæ™¯">æœ€ä½³å®è·µåœºæ™¯</h4>
<ul>
<li>å±•ç¤ºç±»ï¼šéšç§åè®®ã€ç”¨æˆ·åè®®ç­‰</li>
<li>äº’åŠ¨ç±»ï¼šè®ºå›ã€å¸®åŠ©æ‰‹å†Œã€è§†é¢‘æ•™ç¨‹ç­‰</li>
</ul>
<p>å‚è€ƒèµ„æ–™</p>
<ul>
<li>https://developer.chrome.com/docs/android/custom-tabs</li>
<li>https://www.chromium.org/Home/</li>
<li>https://developer.apple.com/news/?id=trjs0tcd</li>
</ul>

                </div>
            </article>
        </div>

        
            <div class="next-post">
                <div class="next gt-c-content-color-first">ä¸‹ä¸€ç¯‡</div>
                <a href="https://liyuyu.cn/post/my-2023/" class="post-title gt-a-link">
                    æˆ‘çš„ 2023
                </a>
            </div>
        

        

        

        

        <div class="site-footer gt-c-content-color-first">
    <div class="slogan gt-c-content-color-first"><p><a href="http://beian.miit.gov.cn" target="_blank">ç²¤ICPå¤‡14087112å·-1</a></p></div>
    <div class="social-container">
        
            
        
            
        
            
        
            
        
            
        
            
        
    </div>
    <div class="footer-info">
        Powered by <a href="https://github.com/getgridea/gridea" target="_blank">Gridea</a>
    </div>
    <div>
        Theme <a href="https://github.com/imhanjie/gridea-theme-pure" target="_blank">Pure</a>, Powered by <a
                href="https://gridea.dev" target="_blank">Gridea</a> | <a href="https://liyuyu.cn/atom.xml" target="_blank">RSS</a>
    </div>
</div>

<script>
  hljs.highlightAll()
</script>

    </div>
</div>
</body>
</html>
